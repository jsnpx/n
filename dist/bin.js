#!/usr/bin/env node
import{cli as l}from"@jsnpx/u";import f from"fs";import p from"path";var c=async(e,o="utf-8")=>{let t;try{let r=await fetch(e,{headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}});if(!r.ok)throw new Error(`HTTP status ${r.status}`);let s=await r.arrayBuffer();t=Buffer.from(s).toString(o)}catch(r){console.log(r)}return t},g=async(e,o="utf-8")=>{let t;try{t=f.readFileSync(p.resolve(e),{encoding:o})}catch(r){console.log(r)}return t},m=async(e,o={})=>{let t,{baseUrl:r,encoding:s,save:i}=o;if(r&&e.indexOf("/")===0&&(e=r+e),e.indexOf("http")===0)t=await c(e,s);else if(e.indexOf("@")===0){let a=e.substring(1).split("/");typ=a[2],a.splice(2,0,"main"),t=await c("https://raw.githubusercontent.com/"+a.join("/"),s)}else Buffer.from(e,"base64").toString("base64")===e?t=Buffer.from(e,"base64").toString("ascii"):t=await g(e,s);return i&&f.writeFileSync(p.resolve(process.cwd(),i),t,{encoding:"utf-8"}),t};var n=l("npx @jsnpx/n",{src:{describe:"Url or path of input",type:"string"}},{s:{describe:"Save",type:"string"},b:{describe:"Base URL",type:"string"},e:{describe:"Encoding",type:"string"}});(async()=>{let e=n.e||(n.s?"utf-8":"base64"),o=await m(n.src,{baseUrl:n.b,encoding:e,save:n.s});o&&console.log(e!=="base64"?Buffer.from(o).toString("base64"):o),process.exit(0)})();
